function enablestart(){var e=document.getElementById("startbutton");e.value="start",e.disabled=null}function startVideo(){vid.play(),ctrack.start(vid),drawLoop()}function drawLoop(){requestAnimFrame(drawLoop),overlayCC.clearRect(0,0,400,300),ctrack.getCurrentPosition()&&ctrack.draw(overlay)}var vid=document.getElementById("videoel"),overlay=document.getElementById("overlay"),overlayCC=overlay.getContext("2d"),ctrack=new clm.tracker({useWebGL:!0});ctrack.init(pModel),stats=new Stats,stats.domElement.style.position="absolute",stats.domElement.style.top="0px",document.getElementById("container").appendChild(stats.domElement);var insertAltVideo=function(e){if(supports_video()){if(supports_ogg_theora_video())e.src="./media/cap12_edit.ogv";else{if(!supports_h264_baseline_video())return!1;e.src="./media/cap12_edit.mp4"}return!0}return!1};if(navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,window.URL=window.URL||window.webkitURL||window.msURL||window.mozURL,navigator.getUserMedia){var videoSelector={video:!0};if(window.navigator.appVersion.match(/Chrome\/(.*?) /)){parseInt(window.navigator.appVersion.match(/Chrome\/(\d+)\./)[1],10)<20&&(videoSelector="video")}navigator.getUserMedia(videoSelector,function(e){vid.mozCaptureStream?vid.mozSrcObject=e:vid.src=window.URL&&window.URL.createObjectURL(e)||e,vid.play()},function(){insertAltVideo(vid),document.getElementById("gum").className="hide",document.getElementById("nogum").className="nohide",alert("There was some problem trying to fetch video from your webcam, using a fallback video instead.")})}else insertAltVideo(vid),document.getElementById("gum").className="hide",document.getElementById("nogum").className="nohide",alert("Your browser does not seem to support getUserMedia, using a fallback video instead.");vid.addEventListener("canplay",enablestart,!1),document.addEventListener("clmtrackrIteration",function(e){stats.update()},!1);