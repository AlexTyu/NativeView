function enablestart(){var e=document.getElementById("startbutton");e.value="start",e.disabled=null}function startVideo(){vid.play(),ctrack.start(vid),drawLoop()}function drawLoop(){requestAnimFrame(drawLoop),overlayCC.clearRect(0,0,400,300),ctrack.getCurrentPosition()&&ctrack.draw(overlay)}var vid=document.getElementById("videoel"),overlay=document.getElementById("overlay"),overlayCC=overlay.getContext("2d"),ctrack=new clm.tracker({useWebGL:!0});if(ctrack.init(pModel),navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,window.URL=window.URL||window.webkitURL||window.msURL||window.mozURL,navigator.getUserMedia){var videoSelector={video:!0};if(window.navigator.appVersion.match(/Chrome\/(.*?) /)){var chromeVersion=parseInt(window.navigator.appVersion.match(/Chrome\/(\d+)\./)[1],10);chromeVersion<20&&(videoSelector="video")}navigator.getUserMedia(videoSelector,function(e){vid.mozCaptureStream?vid.mozSrcObject=e:vid.src=window.URL&&window.URL.createObjectURL(e)||e,vid.play()},function(){alert("There was some problem trying to fetch video from your webcam, using a fallback video instead.")})}vid.addEventListener("canplay",enablestart,!1);